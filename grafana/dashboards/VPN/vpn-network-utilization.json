{"annotations": {"list": [{"builtIn": 1, "datasource": {"type": "grafana", "uid": "-- Grafana --"}, "enable": true, "hide": true, "iconColor": "rgba(0, 211, 255, 1)", "name": "Annotations & Alerts", "type": "dashboard"}]}, "description": "Interface Utilization (%), Uplink Util per Node (%), Bandwidth RX/TX (bps), Top N busiest interfaces. \u041e\u0441\u043d\u043e\u0432\u0430: if_speed_bps + node_network_*; \u043f\u043e\u0440\u043e\u0433\u0438 80/95%.", "editable": true, "fiscalYearStartMonth": 0, "graphTooltip": 0, "links": [], "panels": [{"datasource": "Prometheus", "fieldConfig": {"defaults": {"color": {"mode": "palette-classic"}, "custom": {"axisBorderShow": false, "axisCenteredZero": false, "axisColorMode": "text", "axisLabel": "", "axisPlacement": "auto", "barAlignment": 0, "drawStyle": "line", "fillOpacity": 8, "gradientMode": "none", "hideFrom": {"legend": false, "tooltip": false, "viz": false}, "insertNulls": false, "lineInterpolation": "linear", "lineWidth": 1, "pointSize": 3, "scaleDistribution": {"type": "linear"}, "showPoints": "never", "spanNulls": true, "stacking": {"group": "A", "mode": "none"}, "thresholdsStyle": {"mode": "off"}}, "mappings": [], "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}, {"color": "yellow", "value": 80}, {"color": "red", "value": 95}]}, "unit": "percent"}, "overrides": []}, "gridPos": {"h": 7, "w": 12, "x": 0, "y": 0}, "id": 2, "options": {"legend": {"calcs": ["lastNotNull"], "displayMode": "table", "placement": "right", "showLegend": true}, "tooltip": {"mode": "single", "sort": "none"}}, "targets": [{"datasource": "Prometheus", "editorMode": "code", "expr": "node:uplink_utilization:ratio{name=~\"$node\"} * 100", "instant": false, "legendFormat": "{{name}}", "range": true, "refId": "A"}], "title": "\u041a\u0430\u043d\u0430\u043b \u0443\u0437\u043b\u0430 \u2014 \u0437\u0430\u043d\u044f\u0442\u043e\u0441\u0442\u044c (%)", "type": "timeseries"}, {"datasource": "Prometheus", "fieldConfig": {"defaults": {"color": {"mode": "palette-classic"}, "custom": {"axisBorderShow": false, "axisCenteredZero": false, "axisColorMode": "text", "axisLabel": "", "axisPlacement": "auto", "barAlignment": 0, "drawStyle": "line", "fillOpacity": 8, "gradientMode": "none", "hideFrom": {"legend": false, "tooltip": false, "viz": false}, "insertNulls": false, "lineInterpolation": "linear", "lineWidth": 1, "pointSize": 3, "scaleDistribution": {"type": "linear"}, "showPoints": "never", "spanNulls": true, "stacking": {"group": "A", "mode": "none"}, "thresholdsStyle": {"mode": "off"}}, "mappings": [], "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}, {"color": "yellow", "value": 80}, {"color": "red", "value": 95}]}, "unit": "percent"}, "overrides": []}, "gridPos": {"h": 7, "w": 12, "x": 12, "y": 0}, "id": 1, "options": {"legend": {"calcs": ["lastNotNull"], "displayMode": "table", "placement": "right", "showLegend": true}, "tooltip": {"mode": "single", "sort": "none"}}, "targets": [{"datasource": "Prometheus", "editorMode": "code", "expr": "iface:utilization:ratio{name=~\"$node\"} * 100", "instant": false, "legendFormat": "{{name}} ({{device}})", "range": true, "refId": "A"}], "title": "\u041a\u0430\u043d\u0430\u043b \u043f\u043e \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0430\u043c \u2014 \u0437\u0430\u043d\u044f\u0442\u043e\u0441\u0442\u044c (%)", "type": "timeseries"}, {"datasource": "Prometheus", "description": "", "fieldConfig": {"defaults": {"color": {"mode": "palette-classic"}, "custom": {"axisBorderShow": false, "axisCenteredZero": false, "axisColorMode": "text", "axisLabel": "", "axisPlacement": "auto", "barAlignment": 0, "drawStyle": "line", "fillOpacity": 8, "gradientMode": "none", "hideFrom": {"legend": false, "tooltip": false, "viz": false}, "insertNulls": false, "lineInterpolation": "linear", "lineWidth": 1, "pointSize": 3, "scaleDistribution": {"type": "linear"}, "showPoints": "never", "spanNulls": true, "stacking": {"group": "A", "mode": "none"}, "thresholdsStyle": {"mode": "off"}}, "mappings": [], "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}, {"color": "red", "value": 80}]}, "unit": "bps"}, "overrides": []}, "gridPos": {"h": 7, "w": 12, "x": 0, "y": 7}, "id": 3, "options": {"legend": {"calcs": ["lastNotNull"], "displayMode": "table", "placement": "right", "showLegend": true}, "tooltip": {"mode": "single", "sort": "none"}}, "targets": [{"datasource": "Prometheus", "editorMode": "code", "expr": "node:bps:rx{name=~\"$node\"}", "instant": false, "legendFormat": "RX {{name}}", "range": true, "refId": "A"}, {"datasource": "Prometheus", "editorMode": "code", "expr": "node:bps:tx{name=~\"$node\"}", "hide": false, "instant": false, "legendFormat": "TX {{name}}", "range": true, "refId": "B"}, {"datasource": "Prometheus", "editorMode": "code", "expr": "node:bps:total{name=~\"$node\"}", "hide": false, "instant": false, "legendFormat": "Total {{name}}", "range": true, "refId": "C"}], "title": "\u041a\u0430\u043d\u0430\u043b \u2014 \u0442\u0440\u0430\u0444\u0438\u043a RX/TX (\u0431\u0438\u0442/\u0441)", "type": "timeseries"}, {"datasource": "Prometheus", "description": "", "fieldConfig": {"defaults": {"color": {"mode": "palette-classic"}, "custom": {"axisBorderShow": false, "axisCenteredZero": false, "axisColorMode": "text", "axisLabel": "", "axisPlacement": "auto", "barAlignment": 0, "drawStyle": "line", "fillOpacity": 8, "gradientMode": "none", "hideFrom": {"legend": false, "tooltip": false, "viz": false}, "insertNulls": false, "lineInterpolation": "linear", "lineWidth": 1, "pointSize": 3, "scaleDistribution": {"type": "linear"}, "showPoints": "never", "spanNulls": true, "stacking": {"group": "A", "mode": "none"}, "thresholdsStyle": {"mode": "off"}}, "mappings": [], "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}, {"color": "red", "value": 80}]}, "unit": "percent"}, "overrides": []}, "gridPos": {"h": 7, "w": 12, "x": 12, "y": 7}, "id": 4, "options": {"legend": {"calcs": ["lastNotNull"], "displayMode": "table", "placement": "right", "showLegend": true}, "tooltip": {"mode": "single", "sort": "none"}}, "targets": [{"datasource": "Prometheus", "editorMode": "code", "expr": "topk(5, node:uplink_utilization:ratio) * 100", "instant": false, "legendFormat": "{{name}}", "range": true, "refId": "A"}], "title": "\u0422\u041e\u041f N \u043f\u043e \u0437\u0430\u043d\u044f\u0442\u043e\u0441\u0442\u0438 \u043a\u0430\u043d\u0430\u043b\u0430 (%)", "type": "timeseries"}, {"datasource": "Prometheus", "fieldConfig": {"defaults": {"color": {"mode": "palette-classic"}, "custom": {"axisBorderShow": false, "axisCenteredZero": false, "axisColorMode": "text", "axisLabel": "", "axisPlacement": "auto", "barAlignment": 0, "drawStyle": "line", "fillOpacity": 8, "gradientMode": "none", "hideFrom": {"legend": false, "tooltip": false, "viz": false}, "insertNulls": false, "lineInterpolation": "linear", "lineWidth": 2, "pointSize": 3, "scaleDistribution": {"type": "linear"}, "showPoints": "never", "spanNulls": true, "stacking": {"group": "A", "mode": "none"}, "thresholdsStyle": {"mode": "off"}}, "decimals": 0, "mappings": [], "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}, {"color": "red", "value": 80}]}, "unit": "Mbits"}, "overrides": [{"matcher": {"id": "byRegexp", "options": "^Age \\(h\\).*"}, "properties": [{"id": "unit", "value": "h"}, {"id": "custom.hideFrom", "value": {"legend": false, "tooltip": false, "viz": true}}, {"id": "custom.axisPlacement", "value": "hidden"}]}]}, "gridPos": {"h": 8, "w": 12, "x": 0, "y": 14}, "id": 5, "options": {"legend": {"calcs": ["lastNotNull"], "displayMode": "table", "placement": "right", "showLegend": true, "sortBy": "Last *", "sortDesc": true}, "tooltip": {"mode": "single", "sort": "none"}}, "targets": [{"datasource": "Prometheus", "editorMode": "code", "expr": "ru:wg:throughput_uplink_bps{name=~\"$node\"} / 1e6", "instant": false, "legendFormat": "{{name}} \u2014 Up", "range": true, "refId": "A"}, {"datasource": "Prometheus", "editorMode": "code", "expr": "ru:wg:throughput_downlink_bps{name=~\"$node\"} / 1e6", "hide": false, "instant": false, "legendFormat": "{{name}} \u2014 Down", "range": true, "refId": "B"}, {"datasource": "Prometheus", "editorMode": "code", "expr": "ru:wg:last_run_age_seconds{name=~\"$node\"} / 3600", "instant": false, "legendFormat": "Age (h) {{name}}", "range": true, "refId": "C"}], "title": "\u041f\u0440\u043e\u043f\u0443\u0441\u043a\u043d\u0430\u044f \u0441\u043f\u043e\u0441\u043e\u0431\u043d\u043e\u0441\u0442\u044c WG (RU\u2194EU)", "type": "timeseries"}, {"datasource": "Prometheus", "fieldConfig": {"defaults": {"color": {"mode": "palette-classic"}, "custom": {"axisBorderShow": false, "axisCenteredZero": false, "axisColorMode": "text", "axisLabel": "", "axisPlacement": "auto", "barAlignment": 0, "drawStyle": "line", "fillOpacity": 8, "gradientMode": "none", "hideFrom": {"legend": false, "tooltip": false, "viz": false}, "insertNulls": false, "lineInterpolation": "linear", "lineWidth": 2, "pointSize": 3, "scaleDistribution": {"type": "linear"}, "showPoints": "never", "spanNulls": true, "stacking": {"group": "A", "mode": "none"}, "thresholdsStyle": {"mode": "off"}}, "decimals": 0, "mappings": [], "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}, {"color": "red", "value": 80}]}, "unit": "Mbps"}, "overrides": [{"matcher": {"id": "byRegexp", "options": "^Age \\(h\\).*"}, "properties": [{"id": "unit", "value": "h"}, {"id": "custom.hideFrom", "value": {"legend": false, "tooltip": false, "viz": true}}, {"id": "custom.axisPlacement", "value": "hidden"}]}]}, "gridPos": {"h": 8, "w": 12, "x": 12, "y": 14}, "id": 8, "options": {"legend": {"calcs": ["lastNotNull"], "displayMode": "table", "placement": "right", "showLegend": true}, "tooltip": {"mode": "multi", "sort": "none"}}, "targets": [{"datasource": "Prometheus", "editorMode": "code", "expr": "node:internet_download_bps:latest{name=~\"$node\"} / 1e6", "instant": false, "legendFormat": "{{name}} \u2014 DL", "range": true, "refId": "A"}, {"datasource": "Prometheus", "editorMode": "code", "expr": "node:internet_upload_bps:latest{name=~\"$node\"} / 1e6", "hide": false, "instant": false, "legendFormat": "{{name}} \u2014 UL", "range": true, "refId": "B"}, {"datasource": "Prometheus", "editorMode": "code", "expr": "node:internet_speed_last_age_seconds{name=~\"$node\"} / 3600", "instant": false, "legendFormat": "Age (h) {{name}}", "range": true, "refId": "C"}], "title": "Speedtest DL/UL (Mbps)", "type": "timeseries"}], "refresh": "1m", "schemaVersion": 39, "tags": ["vpn", "network", "utilization", "bandwidth", "speedtest"], "templating": {"list": [{"current": {"selected": true, "text": ["All"], "value": ["$__all"]}, "datasource": "Prometheus", "definition": "label_values(if_speed_bps, instance)", "hide": 2, "includeAll": true, "multi": true, "name": "instance", "options": [], "query": {"qryType": 5, "query": "label_values(if_speed_bps, instance)", "refId": "PrometheusVariableQueryEditor-VariableQuery"}, "refresh": 2, "regex": "", "skipUrlSync": false, "sort": 0, "type": "query"}, {"current": {"selected": true, "text": ["All"], "value": ["$__all"]}, "datasource": "Prometheus", "definition": "label_values(if_speed_bps, name)", "hide": 0, "includeAll": true, "multi": true, "name": "node", "options": [], "query": {"qryType": 5, "query": "label_values(if_speed_bps, name)", "refId": "PrometheusVariableQueryEditor-VariableQuery"}, "refresh": 2, "regex": "", "skipUrlSync": false, "sort": 0, "type": "query"}]}, "time": {"from": "now-6h", "to": "now"}, "timepicker": {}, "timezone": "browser", "title": "VPN/\u0421\u0435\u0442\u044c \u2014 \u0417\u0430\u043d\u044f\u0442\u043e\u0441\u0442\u044c \u0438 \u0442\u0440\u0430\u0444\u0438\u043a", "uid": "vpn-network-utilization", "version": 7, "weekStart": ""}