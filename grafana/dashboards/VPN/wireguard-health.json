{"annotations": {"list": [{"builtIn": 1, "datasource": {"type": "grafana", "uid": "-- Grafana --"}, "enable": true, "hide": true, "iconColor": "rgba(0, 211, 255, 1)", "name": "Annotations & Alerts", "type": "dashboard"}]}, "editable": true, "fiscalYearStartMonth": 0, "graphTooltip": 1, "links": [], "panels": [{"datasource": "Prometheus", "fieldConfig": {"defaults": {"custom": {"align": "auto", "cellOptions": {"type": "auto"}, "inspect": false}, "mappings": [], "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}, {"color": "red", "value": 80}]}}, "overrides": [{"matcher": {"id": "byName", "options": "status"}, "properties": [{"id": "mappings", "value": [{"options": {"0": {"color": "red", "index": 0, "text": "OFF"}, "1": {"color": "green", "index": 1, "text": "ON"}}, "type": "value"}]}]}, {"matcher": {"id": "byName", "options": "interface"}, "properties": [{"id": "custom.width", "value": 116}]}, {"matcher": {"id": "byName", "options": "name"}, "properties": [{"id": "custom.width", "value": 134}]}, {"matcher": {"id": "byName", "options": "peer"}, "properties": [{"id": "custom.width", "value": 393}]}, {"matcher": {"id": "byName", "options": "Time"}, "properties": [{"id": "custom.width", "value": 197}]}, {"matcher": {"id": "byName", "options": "endpoint"}, "properties": [{"id": "custom.width", "value": 179}]}, {"matcher": {"id": "byName", "options": "instance"}, "properties": [{"id": "custom.width", "value": 145}]}, {"matcher": {"id": "byName", "options": "role"}, "properties": [{"id": "custom.width", "value": 207}]}]}, "gridPos": {"h": 8, "w": 24, "x": 0, "y": 0}, "id": 1, "options": {"cellHeight": "sm", "footer": {"countRows": false, "fields": "", "reducer": ["sum"], "show": false}, "frameIndex": 0, "showHeader": true, "sortBy": []}, "pluginVersion": "10.4.5", "targets": [{"datasource": "Prometheus", "editorMode": "code", "exemplar": false, "expr": "wg:peer:connected{name=~\"$node\"}", "format": "table", "instant": true, "legendFormat": "", "range": false, "refId": "A"}], "title": "Peers \u2014 status", "transformations": [{"id": "organize", "options": {"excludeByName": {"__name__": true}, "includeByName": {}, "indexByName": {"Time": 0, "Value": 8, "__name__": 2, "endpoint": 3, "instance": 4, "interface": 5, "name": 1, "peer": 6, "role": 7}, "renameByName": {"Value": "status"}}}], "type": "table"}, {"datasource": "Prometheus", "fieldConfig": {"defaults": {"color": {"mode": "palette-classic"}, "custom": {"axisBorderShow": false, "axisCenteredZero": false, "axisColorMode": "text", "axisLabel": "", "axisPlacement": "auto", "barAlignment": 0, "drawStyle": "line", "fillOpacity": 0, "gradientMode": "none", "hideFrom": {"legend": false, "tooltip": false, "viz": false}, "insertNulls": false, "lineInterpolation": "linear", "lineWidth": 1, "pointSize": 5, "scaleDistribution": {"type": "linear"}, "showPoints": "auto", "spanNulls": false, "stacking": {"group": "A", "mode": "none"}, "thresholdsStyle": {"mode": "off"}}, "mappings": [], "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}, {"color": "yellow", "value": 180}, {"color": "red", "value": 300}]}, "unit": "s"}, "overrides": []}, "gridPos": {"h": 8, "w": 12, "x": 0, "y": 8}, "id": 2, "options": {"legend": {"calcs": ["lastNotNull"], "displayMode": "table", "placement": "right", "showLegend": true}, "tooltip": {"mode": "single", "sort": "none"}}, "targets": [{"datasource": "Prometheus", "editorMode": "code", "expr": "wg:peer:handshake_age_seconds{name=~\"$node\"}", "legendFormat": "{{name}}", "range": true, "refId": "A"}], "title": "Handshake age (s)", "type": "timeseries"}, {"datasource": "Prometheus", "fieldConfig": {"defaults": {"color": {"mode": "palette-classic"}, "custom": {"axisBorderShow": false, "axisCenteredZero": false, "axisColorMode": "text", "axisLabel": "", "axisPlacement": "auto", "barAlignment": 0, "drawStyle": "line", "fillOpacity": 0, "gradientMode": "none", "hideFrom": {"legend": false, "tooltip": false, "viz": false}, "insertNulls": false, "lineInterpolation": "linear", "lineWidth": 1, "pointSize": 5, "scaleDistribution": {"type": "linear"}, "showPoints": "auto", "spanNulls": false, "stacking": {"group": "A", "mode": "none"}, "thresholdsStyle": {"mode": "off"}}, "mappings": [], "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}, {"color": "red", "value": 80}]}, "unit": "bps"}, "overrides": []}, "gridPos": {"h": 8, "w": 12, "x": 12, "y": 8}, "id": 3, "options": {"legend": {"calcs": ["lastNotNull"], "displayMode": "table", "placement": "right", "showLegend": true}, "tooltip": {"mode": "single", "sort": "none"}}, "targets": [{"datasource": "Prometheus", "editorMode": "code", "expr": "wg:peer:rx_bps{name=~\"$node\"}", "legendFormat": "RX {{name}}", "range": true, "refId": "A"}, {"datasource": "Prometheus", "editorMode": "code", "expr": "wg:peer:tx_bps{name=~\"$node\"}", "legendFormat": "TX {{name}}", "range": true, "refId": "B"}], "title": "Throughput per peer (bps)", "type": "timeseries"}, {"datasource": "Prometheus", "fieldConfig": {"defaults": {"mappings": [], "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}, {"color": "red", "value": 80}]}, "unit": "bps"}, "overrides": []}, "gridPos": {"h": 6, "w": 8, "x": 0, "y": 16}, "id": 4, "options": {"colorMode": "value", "graphMode": "area", "justifyMode": "auto", "orientation": "auto", "reduceOptions": {"calcs": ["lastNotNull"], "fields": "", "values": false}, "showPercentChange": false, "textMode": "auto", "wideLayout": true}, "pluginVersion": "10.4.5", "targets": [{"datasource": "Prometheus", "editorMode": "code", "expr": "sum by (instance, name) (wg:peer:total_bps{name=~\"$node\"})", "instant": true, "legendFormat": "{{name}}", "refId": "A"}], "title": "Total WG traffic (bps) \u2014 node", "type": "stat"}, {"datasource": "Prometheus", "fieldConfig": {"defaults": {"mappings": [], "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}, {"color": "red", "value": 1}]}, "unit": "none"}, "overrides": []}, "gridPos": {"h": 6, "w": 8, "x": 8, "y": 16}, "id": 5, "options": {"colorMode": "value", "graphMode": "area", "justifyMode": "auto", "orientation": "auto", "reduceOptions": {"calcs": ["lastNotNull"], "fields": "", "values": false}, "showPercentChange": false, "textMode": "auto", "wideLayout": true}, "pluginVersion": "10.4.5", "targets": [{"datasource": "Prometheus", "editorMode": "code", "expr": "count without (endpoint) (wireguard_peer_connected{name=~\"$node\"}) - 1", "instant": true, "legendFormat": "{{name}}", "refId": "A"}], "title": "Endpoint flap (current overlap)", "type": "stat"}, {"datasource": "Prometheus", "fieldConfig": {"defaults": {"mappings": [], "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}, {"color": "red", "value": 80}]}, "unit": "bps"}, "overrides": []}, "gridPos": {"h": 6, "w": 8, "x": 16, "y": 16}, "id": 6, "options": {"displayMode": "gradient", "maxVizHeight": 300, "minVizHeight": 16, "minVizWidth": 8, "namePlacement": "auto", "orientation": "auto", "reduceOptions": {"calcs": ["lastNotNull"], "fields": "", "values": false}, "showUnfilled": true, "sizing": "auto", "valueMode": "color"}, "pluginVersion": "10.4.5", "targets": [{"datasource": "Prometheus", "editorMode": "code", "expr": "topk(5, wg:peer:total_bps{name=~\"$node\"})", "instant": true, "legendFormat": "{{name}}", "refId": "A"}], "title": "Top 5 peers by total bps", "type": "bargauge"}], "refresh": "10s", "schemaVersion": 39, "tags": ["wireguard", "vpn", "health"], "templating": {"list": [{"current": {"selected": false, "text": "All", "value": "$__all"}, "datasource": "Prometheus", "definition": "label_values(wg:peer:connected, name)", "hide": 0, "includeAll": true, "label": "Node", "multi": true, "name": "node", "options": [], "query": "label_values(wg:peer:connected, name)", "refresh": 2, "regex": "", "skipUrlSync": false, "sort": 0, "type": "query"}, {"current": {"selected": false, "text": "10.66.0.2:9100", "value": "10.66.0.2:9100"}, "datasource": "Prometheus", "definition": "label_values(wg:peer:connected{name=~\"$node\"}, instance)", "hide": 2, "includeAll": true, "label": "instance", "multi": true, "name": "instance", "options": [], "query": "label_values(wg:peer:connected{name=~\"$node\"}, instance)", "refresh": 2, "regex": "", "skipUrlSync": false, "sort": 0, "type": "query"}]}, "time": {"from": "now-6h", "to": "now"}, "timepicker": {"refresh_intervals": ["5s", "10s", "30s", "1m", "5m"]}, "timezone": "browser", "title": "WireGuard Health", "uid": "wireguard-health", "version": 7, "weekStart": ""}