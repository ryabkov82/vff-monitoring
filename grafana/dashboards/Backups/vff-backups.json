{"annotations": {"list": [{"builtIn": 1, "datasource": {"type": "grafana", "uid": "-- Grafana --"}, "enable": true, "hide": true, "iconColor": "rgba(0, 211, 255, 1)", "name": "Annotations & Alerts", "type": "dashboard"}]}, "editable": true, "fiscalYearStartMonth": 0, "graphTooltip": 0, "links": [], "panels": [{"datasource": "Prometheus", "fieldConfig": {"defaults": {"mappings": [{"options": {"match": "null", "result": {"text": "0"}}, "type": "special"}], "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}, {"color": "red", "value": 1}]}, "unit": "none"}, "overrides": []}, "gridPos": {"h": 7, "w": 6, "x": 0, "y": 0}, "id": 1, "options": {"colorMode": "value", "graphMode": "none", "justifyMode": "auto", "orientation": "horizontal", "reduceOptions": {"calcs": ["lastNotNull"], "fields": "", "values": false}, "showPercentChange": false, "textMode": "value", "wideLayout": true}, "pluginVersion": "10.4.5", "targets": [{"datasource": "Prometheus", "editorMode": "code", "expr": "sum(backup:last_status{name=~\"$name\"} != 0)", "instant": true, "legendFormat": "failures", "refId": "A"}], "title": "Backups \u2014 Failures (non-zero status)", "type": "stat"}, {"datasource": "Prometheus", "fieldConfig": {"defaults": {"decimals": 1, "mappings": [], "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}, {"color": "orange", "value": 26}, {"color": "red", "value": 36}]}, "unit": "h"}, "overrides": []}, "gridPos": {"h": 7, "w": 6, "x": 6, "y": 0}, "id": 2, "options": {"displayMode": "gradient", "maxVizHeight": 300, "minVizHeight": 16, "minVizWidth": 8, "namePlacement": "auto", "orientation": "horizontal", "reduceOptions": {"calcs": ["lastNotNull"], "fields": "", "values": false}, "showUnfilled": true, "sizing": "auto", "valueMode": "color"}, "pluginVersion": "10.4.5", "targets": [{"datasource": "Prometheus", "editorMode": "code", "expr": "(backup:last_run_age_seconds{name=~\"$name\"})/3600", "instant": true, "legendFormat": "{{name}}", "refId": "A"}], "title": "Last run age (hours)", "type": "bargauge"}, {"datasource": "Prometheus", "fieldConfig": {"defaults": {"decimals": 1, "mappings": [], "thresholds": {"mode": "absolute", "steps": [{"color": "red", "value": null}, {"color": "orange", "value": 5000000}, {"color": "green", "value": 50000000}]}, "unit": "bytes"}, "overrides": []}, "gridPos": {"h": 7, "w": 6, "x": 12, "y": 0}, "id": 3, "options": {"displayMode": "basic", "maxVizHeight": 300, "minVizHeight": 16, "minVizWidth": 8, "namePlacement": "auto", "orientation": "horizontal", "reduceOptions": {"calcs": ["lastNotNull"], "fields": "", "values": false}, "showUnfilled": true, "sizing": "auto", "valueMode": "color"}, "pluginVersion": "10.4.5", "targets": [{"datasource": "Prometheus", "editorMode": "code", "expr": "backup:last_size_bytes{name=~\"$name\"}", "instant": true, "legendFormat": "{{name}}", "refId": "A"}], "title": "Last backup size", "type": "bargauge"}, {"datasource": "Prometheus", "fieldConfig": {"defaults": {"decimals": 0, "mappings": [], "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}, {"color": "orange", "value": 300}, {"color": "red", "value": 900}]}, "unit": "s"}, "overrides": []}, "gridPos": {"h": 7, "w": 6, "x": 18, "y": 0}, "id": 4, "options": {"displayMode": "gradient", "maxVizHeight": 300, "minVizHeight": 16, "minVizWidth": 8, "namePlacement": "auto", "orientation": "horizontal", "reduceOptions": {"calcs": ["lastNotNull"], "fields": "", "values": false}, "showUnfilled": true, "sizing": "auto", "valueMode": "color"}, "pluginVersion": "10.4.5", "targets": [{"datasource": "Prometheus", "editorMode": "code", "expr": "backup:last_duration_seconds{name=~\"$name\"}", "instant": true, "legendFormat": "{{name}}", "refId": "A"}], "title": "Last backup duration", "type": "bargauge"}, {"datasource": "Prometheus", "fieldConfig": {"defaults": {"custom": {"align": "auto", "cellOptions": {"type": "auto"}, "inspect": false}, "mappings": [], "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}]}}, "overrides": [{"matcher": {"id": "byName", "options": "status"}, "properties": [{"id": "mappings", "value": [{"options": {"0": {"text": "OK"}}, "type": "value"}, {"options": {"from": 1e-07, "result": {"text": "FAIL"}, "to": 1000000000000}, "type": "range"}]}, {"id": "thresholds", "value": {"mode": "absolute", "steps": [{"color": "green", "value": null}, {"color": "red", "value": 1}]}}]}, {"matcher": {"id": "byName", "options": "size_bytes"}, "properties": [{"id": "unit", "value": "bytes"}]}, {"matcher": {"id": "byName", "options": "duration_s"}, "properties": [{"id": "unit", "value": "s"}]}, {"matcher": {"id": "byName", "options": "last_run_at"}, "properties": [{"id": "unit", "value": "dateTimeFromNow"}]}]}, "gridPos": {"h": 7, "w": 24, "x": 0, "y": 7}, "id": 5, "options": {"cellHeight": "sm", "footer": {"countRows": false, "fields": "", "reducer": ["sum"], "show": false}, "footers": [], "showHeader": true}, "pluginVersion": "10.4.5", "targets": [{"datasource": "Prometheus", "editorMode": "code", "expr": "max by (name, instance) (backup_last_status)", "format": "table", "instant": true, "legendFormat": "status", "refId": "S"}, {"datasource": "Prometheus", "editorMode": "code", "expr": "(time() - max by (name, instance) (backup_last_run_timestamp_seconds)) / 3600 or on(name, instance) (0 * max by (name, instance) (backup_last_status))", "format": "table", "instant": true, "legendFormat": "age_h", "refId": "A"}, {"datasource": "Prometheus", "editorMode": "code", "expr": "max by (name, instance) (backup_last_size_bytes) or on(name, instance) (0 * max by (name, instance) (backup_last_status))", "format": "table", "instant": true, "legendFormat": "size_bytes", "refId": "B"}, {"datasource": "Prometheus", "editorMode": "code", "expr": "max by (name, instance) (backup_last_duration_seconds) or on(name, instance) (0 * max by (name, instance) (backup_last_status))", "format": "table", "instant": true, "legendFormat": "duration_s", "refId": "C"}, {"datasource": "Prometheus", "editorMode": "code", "expr": "(max by (name, instance) (backup_last_run_timestamp_seconds)) * 1000", "format": "table", "instant": true, "legendFormat": "last_run_at", "refId": "T"}], "title": "Backups \u2014 details", "transformations": [{"id": "labelsToFields", "options": {"mode": "columns"}}, {"id": "merge", "options": {}}, {"id": "groupBy", "options": {"fields": {"Value #A": {"aggregations": ["lastNotNull"], "operation": "aggregate"}, "Value #B": {"aggregations": ["lastNotNull"], "operation": "aggregate"}, "Value #C": {"aggregations": ["lastNotNull"], "operation": "aggregate"}, "Value #S": {"aggregations": ["lastNotNull"], "operation": "aggregate"}, "Value #T": {"aggregations": ["lastNotNull"], "operation": "aggregate"}, "instance": {"aggregations": [], "operation": "groupby"}, "name": {"aggregations": [], "operation": "groupby"}}}}, {"id": "organize", "options": {"excludeByName": {"Time": true, "Value #A (lastNotNull)": true, "__name__": true}, "order": ["name", "instance", "status", "size_bytes", "duration_s", "last_run_at"], "renameByName": {"Value #B (lastNotNull)": "size_bytes", "Value #C (lastNotNull)": "duration_s", "Value #S (lastNotNull)": "status", "Value #T (lastNotNull)": "last_run_at"}}}, {"id": "sortBy", "options": {"fields": {}, "sort": [{"desc": true, "field": "age_h"}]}}, {"id": "sortBy", "options": {"fields": {}, "sort": [{"desc": false, "field": "last_run_at"}]}}], "type": "table"}], "refresh": "30s", "schemaVersion": 39, "tags": ["vff", "backup", "monitoring"], "templating": {"list": [{"current": {"text": "All", "value": "$__all"}, "datasource": "Prometheus", "definition": "label_values(backup:last_status, name)", "hide": 0, "includeAll": true, "label": "Backup name", "multi": true, "name": "name", "query": {"qryType": 1, "query": "label_values(backup:last_status, name)", "refId": "PrometheusVariableQueryEditor-VariableQuery"}, "refresh": 1, "regex": "", "skipUrlSync": false, "sort": 1, "type": "query"}]}, "time": {"from": "now-30d", "to": "now"}, "timepicker": {"refresh_intervals": ["5s", "10s", "30s", "1m", "5m"]}, "timezone": "", "title": "Backups", "uid": "vff-backups", "version": 23, "weekStart": ""}