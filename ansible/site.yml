---
- name: Hub (monitoring server)
  hosts: hub
  roles:
    - { role: wireguard_hub, tags: [wg, wg_hub] }
    - { role: docker, when: docker_install | bool, tags: [docker] }   # установка Docker/Compose
    - { role: node_exporter, tags: [node_exporter], vars: { wg_ip: "{{ hub_wg_ip }}" } }
    - { role: nginx, tags: [nginx] }    # reverse-proxy, certs, htpasswd
    - { role: hub, tags: [hub] }
    - { role: ru_probe, when: ru_probe_enabled | bool, tags: [ru_probe] }

- name: VPN nodes
  hosts: vpn
  roles:
    - { role: wireguard_node, tags: [wg, wg_node] }
    - { role: node, tags: [node, node_iperf] }     # iperf3@PORT, скрипты и пр.
    - { role: node_exporter, tags: [node_exporter] }
